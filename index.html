
<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Escape Room Matem√°tico</title>

<style>
:root{--bg:#0b1020;--text:#fff}
*{box-sizing:border-box}
body{
  margin:0;font-family:system-ui,Segoe UI,Roboto,Arial;
  background:#0b1020;color:#fff;
  min-height:100vh;display:flex;justify-content:center;align-items:center;padding:16px
}
.app{width:100%;max-width:980px;background:#111827;border-radius:20px;overflow:hidden}
header{display:flex;justify-content:space-between;padding:14px;background:#020617}
.badge{padding:8px 12px;border-radius:999px;background:#1f2933;font-weight:700}
main{padding:18px}
.panel{background:#020617;border-radius:16px;padding:18px}
.panel.success{background:#064e3b}
.panel.fail{background:#7f1d1d}
.question{font-size:22px;font-weight:800}
.answers{display:grid;gap:10px;margin-top:14px}
button{
  background:#1f2933;color:#fff;border:none;
  padding:14px;border-radius:14px;
  font-size:16px;cursor:pointer
}
button.primary{background:#38bdf8;font-weight:800;color:#000}
.chips{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
.chip{padding:8px 12px;border-radius:999px;background:#334155;font-weight:900}
input{
  width:100%;padding:14px;border-radius:14px;
  border:none;margin-top:10px;font-size:16px
}
.progress{height:8px;background:#1f2933;border-radius:999px;overflow:hidden;margin-bottom:12px}
.progress div{height:100%;background:#38bdf8;width:0%}
video{width:100%;border-radius:14px;margin-top:14px}
</style>
</head>

<body>
<div class="app">
<header>
  <div class="badge" id="stage">ü™Ñ Introducci√≥n</div>
  <div class="badge" id="timer">‚è≥ 12:00</div>
</header>

<main>
  <div class="panel" id="panel">
    <div class="progress"><div id="bar"></div></div>
    <div id="screen"></div>
  </div>
</main>
</div>

<script>
const GAME=[
{w:"MAGIA",q:[
["(-3)+5¬∑2-4",["7","-1","3"],["X","K","I"],2],
["8-(-2)¬∑3+1",["11","15","3"],["B","A","G"],1],
["(-5)¬∑2+8√∑(-4)",["-12","-14","-8"],["G","O","F"],0],
["12√∑(-3)+(-2)¬∑5",["-18","-6","-14"],["U","P","A"],2],
["(-6)+4¬∑(-2)-3",["-17","-13","-11"],["M","Q","S"],0]
]},
{w:"BRUJA",q:[
["35% de 200",["70","65","75"],["J","U","M"],0],
["60% es 48",["80","88","72"],["U","M","B"],0],
["18 de 72 (%)",["30%","20%","25%"],["Z","N","B"],2],
["150‚Ç¨ +20%",["180‚Ç¨","190‚Ç¨","170‚Ç¨"],["A","Z","I"],0],
["200‚Ç¨ ‚àí15%",["160‚Ç¨","170‚Ç¨","180‚Ç¨"],["P","R","K"],1]
]},
{w:"HADAS",q:[
["4 m ‚Üí 24‚Ç¨, 7 ‚Üí ?",["38","46","42"],["C","C","A"],2],
["6 L/100 km en 350 km",["18","21","24"],["J","A","T"],1],
["18 ‚Üí 450 g, 12 ‚Üí ?",["350","250","300"],["Y","T","D"],2],
["8 obreros 15 d√≠as, 12 ‚Üí ?",["10","8","12"],["H","S","K"],0],
["Piscina 12 h, 3 mangueras",["6","4","3"],["M","S","G"],1]
]},
{w:"RUNAS",q:[
["2/3 + 1/4",["11/12","3/7","6/12","8/12"],["R","U","N","A"],0],
["5/6 - 1/3",["1/2","4/3","2/3","1/6"],["U","R","A","S"],0],
["3/4 ¬∑ 2/5",["3/10","6/20","5/9","6/9"],["N","R","U","A"],0],
["2/3 √∑ 4/9",["3/2","8/27","6/12","2/3"],["A","U","R","N"],0],
["1/2 + 3/8 - 1/4",["5/8","3/8","7/8","1/8"],["S","R","U","N"],0]
]}
];

const stage=document.getElementById("stage");
const timer=document.getElementById("timer");
const bar=document.getElementById("bar");
const screen=document.getElementById("screen");
const panel=document.getElementById("panel");

let sala=0,p=0,letras=[],intentos=3,t=720,clk;

function intro(){
  stage.textContent="ü™Ñ Misi√≥n";
  timer.textContent="‚è≥ 12:00";
  screen.innerHTML=`
    <h1>ü™Ñ El Hechizo del Conocimiento</h1>
    <p>Supera las salas resolviendo retos matem√°ticos.</p>
    <button class="primary" onclick="start()">üöÄ COMENZAR</button>
  `;
}
function start(){
  sala=0;p=0;letras=[];intentos=3;
  startTimer();pregunta();
}
function startTimer(){
  clearInterval(clk);t=720;
  clk=setInterval(()=>{
    t--;timer.textContent=`‚è≥ ${String(t/60|0).padStart(2,"0")}:${String(t%60).padStart(2,"0")}`;
    if(t<=0) reiniciar();
  },1000);
}
function pregunta(){
  panel.className="panel";
  stage.textContent=`üóùÔ∏è Sala ${sala+1}/${GAME.length} ¬∑ Pregunta ${p+1}/5`;
  bar.style.width=(p/5*100)+"%";
  const q=GAME[sala].q[p];
  screen.innerHTML=`
    <div class="question">${q[0]}</div>
    <div class="answers">
      ${q[1].map((t,i)=>`<button onclick="responder(${i})">${t}</button>`).join("")}
    </div>
    <div class="chips">${letras.map(l=>`<span class="chip">${l}</span>`).join("")}</div>
  `;
}
function responder(i){
  const q=GAME[sala].q[p];
  const ok=i===q[3];
  letras.push(q[2][i]);
  screen.innerHTML=`
    <h2>${ok?"‚úÖ Correcta":"‚ùå Incorrecta"}</h2>
    <button class="primary" onclick="seguir()">Continuar</button>
  `;
}
function seguir(){p<4?(p++,pregunta()):palabra();}
function palabra(msg=""){
  screen.innerHTML=`
    <p>Intentos: ${intentos}</p>
    <div class="chips">${letras.map(l=>`<span class="chip">${l}</span>`).join("")}</div>
    <input id="w" placeholder="Palabra final">
    <button class="primary" onclick="comprobar()">Comprobar</button>
    <p>${msg}</p>`;
}
function comprobar(){
  const v=document.getElementById("w").value.toUpperCase().trim();
  if(v===GAME[sala].w){
    panel.className="panel success";
    sala++;sala>=GAME.length?final():reiniciar();
  }else{
    panel.className="panel fail";
    intentos--;intentos>0?palabra("‚ùå Incorrecta"):reiniciar();
  }
}
function reiniciar(){p=0;letras=[];intentos=3;pregunta();}
function final(){
  clearInterval(clk);
  screen.innerHTML=`
    <h1>üèÜ ESCAPE COMPLETADO</h1>
    <video src="puerta.mp4" autoplay muted controls playsinline></video>
    <button class="primary" onclick="intro()">Volver</button>`;
}

intro();
</script>
</body>
</html>
